<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>GoIndia Add-in</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/><link href="1fda685b81e1123773f6.css" rel="stylesheet"/><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body class="ms-font-m ms-welcome ms-Fabric"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"/><script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script><script src="https://accounts.google.com/gsi/client" async defer="defer"></script><style>#buttons{display:flex;flex-direction:row;gap:4px;align-items:flex-start}button{color:#fff;font-weight:400;border:none;border-radius:8px;padding:8px 16px;font-size:14px;margin-top:8px;cursor:pointer;transition:background-color .2s,transform .1s,box-shadow .2s;box-shadow:0 2px 4px rgba(0,0,0,.2)}#refreshBtn{background-color:#275b9f}#refreshBtn:hover{background-color:#173760;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.25)}#refreshBtn:active{transform:translateY(0);box-shadow:0 2px 4px rgba(0,0,0,.2)}#helpBtn{background-color:#d80404}#helpBtn:hover{background-color:#b80000;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.25)}#helpBtn:active{transform:translateY(0);box-shadow:0 2px 4px rgba(0,0,0,.2)}#logoutBtn:hover{background-color:#b80000;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.25)}#profileSection:hover{background-color:#b80000;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.25)}select{border-radius:8px;border:1px solid #ccc;padding:6px 12px;font-size:14px;cursor:pointer;width:250px;transition:border-color .2s,box-shadow .2s}select:focus{border-color:#0078d4;box-shadow:0 0 4px rgba(0,120,212,.5);outline:0}.dropdown{position:relative;width:280px;font-family:Arial,sans-serif}.dropdown-toggle{padding:10px 12px;width:250px;flex-direction:row;align-items:start;border:3px solid #d6e5f5;border-radius:8px;cursor:pointer;background-color:#fff;font-size:14px}.dropdown-toggle:active{border:3px solid #8bbef4}.dropdown-toggle:focus{border:3px solid #8bbef4}.dropdown-menu{position:absolute;top:100%;left:0;right:0;border:1px solid #8bbef4;border-radius:8px;background-color:#fff;max-height:300px;overflow-y:auto;display:none;margin-top:4px}.dropdown-menu.active{display:block;border:1px solid #8bbef4;border-radius:8px}.dropdown-menu input{width:calc(100% - 24px);margin:8px;padding:6px;border:1px solid #ccc;border-radius:6px;font-size:14px}.dropdown-menu ul{list-style:none;padding:0;margin:0}.dropdown-menu li{padding:8px 12px;cursor:pointer}.dropdown-menu li:hover{background-color:#f0f0f0}.arrow-down{width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:6px solid #000}.toggle-container{display:flex;justify-content:flex-end;margin-bottom:5px;margin-left:160px;margin-top:40px;width:120px}.toggle-label{display:flex;align-items:center;justify-content:space-between;background:#e6e6e6;border-radius:10px;cursor:pointer;width:120px;height:29px;font-family:Arial,sans-serif;font-size:13px;font-weight:550;overflow:hidden;position:relative;transition:background-color .2s,transform .1s,box-shadow .2s}.toggle-label:active{transform:translateY(0);box-shadow:0 2px 4px rgba(0,0,0,.2)}.toggle-option{flex:1;text-align:center;z-index:2;transition:color .3s;font-size:12px}.toggle-slider{position:absolute;top:2px;left:2px;width:calc(51% - 4px);height:25px;background:#173760;border-radius:8px;transition:transform .3s;z-index:1}#modeToggle{display:none}#modeToggle:checked+.toggle-label .toggle-slider{transform:translateX(100%)}#modeToggle:checked+.toggle-label .left{color:#000}#modeToggle:checked+.toggle-label .right{color:#fff}#modeToggle:not(:checked)+.toggle-label .left{color:#fff}#modeToggle:not(:checked)+.toggle-label .right{color:#000}#loginScreen{width:100%;max-width:300px;display:flex;justify-content:start;align-items:flex-start}#loginWrapper{display:flex;flex-direction:column;align-items:start;justify-content:flex-start;min-height:100vh;background-color:#f3f4f6;padding:1rem;box-sizing:border-box}.login-container div{display:flex;flex-direction:column;gap:2px;align-items:flex-start}#loginScreen .login-container{background-color:#fff;border-radius:16px;padding:1.5rem 2rem;box-shadow:0 8px 20px rgba(0,0,0,.08);width:100%;max-width:360px;display:flex;flex-direction:column;align-items:center}#loginScreen h2{margin-bottom:1rem;text-align:center;font-size:1.75rem;color:#173760}#loginScreen input[type=email],#loginScreen input[type=password]{width:88%;padding:.6rem .9rem;border-radius:10px;border:1px solid #ccc;outline:0;font-size:.95rem;margin-bottom:.75rem;transition:border .2s;margin-right:20px}#loginScreen input:focus{border-color:#173760}#loginScreen button[type=submit]{width:100%;padding:.6rem .9rem;border-radius:10px;background-color:#173760;color:#fff;font-weight:600;font-size:.95rem;border:none;cursor:pointer;transition:transform .2s}#loginScreen button[type=submit]:hover{transform:scale(1.03)}#loginScreen .divider{display:flex;align-items:center;gap:.3rem;width:100%;margin:1rem 0}#loginScreen .divider hr{flex:1;border-color:#ccc}#loginScreen .divider span{font-size:.8rem;color:#999}#loginScreen .social-buttons{width:100%;display:flex;flex-direction:column;gap:.75rem;align-items:center}#loginScreen .apple-btn{display:flex;align-items:center;justify-content:center;gap:.4rem;background-color:#000;color:#fff;width:100%;padding:.45rem .8rem;border-radius:10px;font-weight:500;cursor:pointer;transition:transform .2s;border:none}#loginScreen .apple-btn:hover{transform:scale(1.03)}#loginScreen .signup{display:flex;align-items:center;justify-content:center;width:100%;margin-top:.75rem;font-size:.8rem;color:#173760}#loginScreen .signup button{background:#173760;border:1px solid #173760;border-radius:10px;height:35px;padding:.2rem .6rem;font-weight:500;cursor:pointer;transition:transform .2s}#loginScreen .signup button:hover{transform:scale(1.03)}#loginScreen .forgot{display:flex;flex-direction:column;gap:.2rem;margin-top:.5rem;width:100%;font-size:.75rem}#loginScreen .forgot button{background:0 0;border:none;color:#173760;cursor:pointer;text-align:left}#loginScreen .forgot button:hover{text-decoration:underline}#blockedContainer,#memberContent{width:100%;display:flex;flex-direction:column;align-items:start;justify-content:start;padding:1rem;box-sizing:border-box}#loginSpinner{border:2px solid #f3f3f3;border-top:2px solid #fff;border-radius:50%;width:16px;height:16px;animation:spin 1s linear infinite;margin:auto}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style><div id="loginWrapper" style="display:flex;justify-content:start;align-items:center;min-height:100vh;background:#f3f4f6;flex-direction:column"><div id="loginScreen" style="width:100%;display:none;justify-content:center"><div class="login-container" id="loginContainer"><img src="https://www.goindiastocks.com/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flogo.eb4c0c16.png&w=1920&q=75" alt="App Logo" style="width:90px;height:60px;margin-bottom:10px"/> <span style="font-family:'Open Sans',sans-serif;font-size:16px;margin-bottom:12px"><span style="color:#173760;font-weight:600">GO INDIA</span> <span style="color:#b80000;font-weight:600">STOCKS</span></span><form id="loginForm"><input required type="email" name="email" placeholder="Email ID"> <input required type="password" name="password" placeholder="Password"> <button type="submit" class="login-btn"><span id="loginText">Login</span><div id="loginSpinner" class="spinner" style="display:none"></div></button></form><div class="divider"><hr><span>OR</span><hr></div><div class="social-buttons"><div id="googleSignInButton"></div></div><div class="signup"><p>Don't have an account?</p><button onclick='window.open("https://www.goindiastocks.com/loginpage","_blank")'>Sign Up</button></div></div></div><div id="memberContent" style="display:none"><div id="addinUI" style="display:none"><a href="https://www.goindiastocks.com/profile" target="_blank" id="profileSection" style="position:absolute;top:5px;left:30px;display:flex;align-items:center;gap:.5rem;background:#fff;padding:.22rem .6rem;border-radius:10px;box-shadow:0 2px 4px rgba(0,0,0,.1);text-decoration:none;color:inherit"><div id="profileIcon" style="width:32px;height:32px;background:#f0f0f0;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;color:#555;font-size:14px">U</div><span id="username" style="font-size:14px;color:#333">Username</span></a><div class="toggle-container"><input type="checkbox" id="modeToggle"/> <label for="modeToggle" class="toggle-label"><span class="toggle-option left">IndAS</span> <span class="toggle-option right">Detailed</span> <span class="toggle-slider"></span></label></div><div class="dropdown" id="customDropdown"><div class="dropdown-toggle" id="dropdownToggle" data-value="">Select Company</div><div class="dropdown-menu" id="dropdownMenu"><input id="dropdownSearch" placeholder="Search company..."/><ul id="dropdownList"></ul></div></div><div id="buttons"><button id="refreshBtn">Refresh</button> <button id="helpBtn">Help</button></div><button id="logoutBtn" style="margin-top:3rem;margin-left:0;background:#fff;color:#b80000;padding:.5rem 1rem;border:1px solid #b80000;border-radius:12px;cursor:pointer;transition:transform .2s,box-shadow .2s">Log Out</button></div></div><div id="blockedContainer" style="display:none;text-align:center;padding:2rem;width:100%"><div style="background:#fff;border-radius:20px;padding:2rem;max-width:400px;margin:auto;display:flex;flex-direction:column;align-items:center;justify-content:center"><img src="https://www.goindiastocks.com/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flogo.eb4c0c16.png&w=1920&q=75" alt="Membership Required" style="width:100px;margin-bottom:1rem"><p style="color:#b80000;font-weight:700;margin-bottom:1rem">Only GIIN Club members can access this add-in.</p><button onclick='window.open("https://www.goindiastocks.com/pricing","_blank")' style="background:#173760;color:#fff;border:none;padding:.5rem 1rem;border-radius:12px;cursor:pointer">Join Now</button></div></div></div><script>function parseJwt(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)}async function handleCredentialResponse(e){try{const t=parseJwt(e.credential),n=t.name,o=t.email;console.log("Parsed user info:",{fullname:n,email:o});let a=await fetch("https://transcriptanalyser.com/payment/getGoogleuser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullname:n,email:o})}),c=await a.json();console.log("User data:",c);let s=await fetch("https://transcriptanalyser.com/payment/check_membership",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:c.UserId})}),d=await s.json();console.log("Membership data:",d),"yes"===d.is_member?(document.getElementById("loginContainer").style.display="none",document.getElementById("memberContent").style.display="block"):(document.getElementById("loginContainer").style.display="none",document.getElementById("blockedContainer").style.display="block")}catch(e){console.error("Login or membership check failed:",e)}}window.onload=function(){google&&google.accounts&&google.accounts.id?(google.accounts.id.initialize({client_id:"588713186952-isq15ehjattbfce2hhhqnuffdfln3nco.apps.googleusercontent.com",callback:handleCredentialResponse}),google.accounts.id.renderButton(document.getElementById("googleSignInButton"),{theme:"outline",size:"large",width:250})):console.error("Google Identity Services not loaded yet.")};let companies=[];async function fetchCompanies(){const e=await fetch("https://transcriptanalyser.com/operational/companies_excel");return await e.json()}function populateCustomDropdown(e){const t=document.getElementById("dropdownList"),n=document.getElementById("dropdownToggle");t.innerHTML="",e.forEach((e,o)=>{const a=document.createElement("li");a.textContent=e.CompName,a.dataset.value=e.fincode,a.dataset.sector=e.sector_type,0===o&&(n.textContent=e.CompName,n.dataset.value=e.fincode,n.dataset.sector=e.sector_type),a.addEventListener("click",()=>{n.textContent=e.CompName,n.dataset.value=e.fincode,n.dataset.sector=e.sector_type,document.getElementById("dropdownMenu").classList.remove("active")}),t.appendChild(a)})}async function initCustomDropdown(){companies=await fetchCompanies(),populateCustomDropdown(companies)}document.getElementById("dropdownToggle").addEventListener("click",()=>{document.getElementById("dropdownMenu").classList.toggle("active")}),document.getElementById("dropdownSearch").addEventListener("input",e=>{const t=e.target.value.toLowerCase();populateCustomDropdown(companies.filter(e=>e.CompName.toLowerCase().includes(t)))});const showMessage=e=>{Office?.Runtime?.displayDialogAsync?console.log(e):alert(e)},getSelectedCompany=()=>{const e=document.getElementById("dropdownToggle");if(!e)return null;const t=e.dataset?.value||"",n=e.textContent?.trim()||"";return t&&n&&"Select Company"!==n?{fincode:t,name:n}:null};document.getElementById("refreshBtn").addEventListener("click",()=>{const e=getSelectedCompany();if(!e)return void alert("⚠ Please select a company before refreshing.");const{fincode:t,name:n}=e,o=document.getElementById("dropdownToggle").dataset.sector,a=document.getElementById("modeToggle"),c=a?.checked?"In":"De";console.log("Refreshing:",n,"| fincode:",t,"| mode:",c,"| sector:",o)}),document.getElementById("helpBtn").addEventListener("click",()=>{const e=getSelectedCompany();if(!e)return void alert("⚠ Please select a company first.");const{fincode:t}=e,n=`https://www.goindiastocks.com/companyinfo/${encodeURIComponent(t)}`;window.open(n,"_blank")}),initCustomDropdown()</script></body></html>